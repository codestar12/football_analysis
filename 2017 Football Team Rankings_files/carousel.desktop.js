define(["jquery","version!fly/utils/string-helper","version!fly/components/carousel"],function(o,t){var h=o.support.touch?"vclick":"click";o.widget("sports.carousel.desktop",o.fly.carousel,{transitionTypes:{slideHorizontalInfiniteWithJumps:{init:function(){this.infinite=true;this.items.canvas.$element.css("left","0")},postInit:function(){var i=this,t=this.options;o(this.items.jumps.selector,this.$element).on(h,function(t){i.goto(parseInt(o(t.target).data("to"),10))});this.items.slides.$elements.removeClass(t.classSelected);o(this.items.slides.$elements[1]).addClass(t.classSelected)},showSlide:function(i){var e=this.options;if(i>0){this.items.canvas.$element.animate({left:-this.slideWidth*i},e.transitionDuration,e.transitionEasing,function(){for(var t=0;t<i;t++){this.items.canvas.$element.append(this.items.slides.$elements[t])}this.items.canvas.$element.css("left","0");this.items.slides.$elements=o(this.items.slides.selector,this.$element);this.transitionTypes[e.transitionType].updateSelectedStates.bind(this)()}.bind(this))}else if(i<0){for(var t=this.items.slides.$elements.length-1;t>=this.items.slides.$elements.length+i;t--){this.items.canvas.$element.prepend(this.items.slides.$elements[t])}this.items.canvas.$element.css("left",this.slideWidth*i+"px");this.items.slides.$elements=o(this.items.slides.selector,this.$element);this.transitionTypes[e.transitionType].updateSelectedStates.bind(this)();this.items.canvas.$element.animate({left:"0"},e.transitionDuration,e.transitionEasing)}},showSlideGoto:function(t){var i=this.options,e=[],s=0;for(var n=0;n<this.items.slides.$elements.length;n++){var h=this.items.slides.$elements[n],l=n+1<this.items.slides.$elements.length?o(this.items.slides.$elements[n+1]):null;if(l==null||l.data("jump")==t){break}e.push(h)}s=e.length;this.items.canvas.$element.animate({left:-this.slideWidth*s},i.transitionDuration,i.transitionEasing,function(){for(var t=0;t<s;t++){this.items.canvas.$element.append(e[t])}this.items.canvas.$element.css("left","0");this.items.slides.$elements=o(this.items.slides.selector,this.$element);this.transitionTypes[i.transitionType].updateSelectedStates.bind(this)()}.bind(this))},updateSelectedStates:function(){var t=this.options,i=o(this.items.slides.$elements[1]),e=o(this.items.jumps.selector+'[data-to="'+i.data("jump")+'"]',this.$element);this.items.slides.$elements.removeClass(t.classSelected);this.items.jumps.$elements.removeClass(t.classSelected);i.addClass(t.classSelected);e.addClass(t.classSelected)}},saagHorizontal:{init:function(){this.items.canvas.$element.css("left","0")},postInit:function(){var i=this,e=this.options;this.transitionTypes[e.transitionType].setWidthsCustom.bind(this)();if(!this.vertical){this._off(this.$window,"resize");this._on(this.$window,{resize:function(t){i.transitionTypes[e.transitionType].setWidthsCustom.bind(this)()}})}var t={},s=h+" "+this.items.next.selector,n=h+" "+this.items.prev.selector;this._off(this.$element,s+" "+n);t[s]=function(t){i.transitionTypes[e.transitionType].customNext.bind(this)()};t[n]=function(t){i.transitionTypes[e.transitionType].customPrev.bind(this)()};this._on(this.$element,t)},showSlide:function(t){var i=this.options,e=0;for(var s=0;s<t;s++){e+=o(this.items.slides.$elements[s]).width()}this.items.canvas.$element.animate({left:-e},i.transitionDuration,i.transitionEasing)},customNext:function(){var t=this.options,i=this.items.slides.$elements.length,e=t.currentSlide+t.incrementAmount>=i?i-1:t.currentSlide+t.incrementAmount;this.pause(true);this.showSlide(e);if(t.hidePreviousOnFirstSlide){this.transitionTypes[t.transitionType].checkPrevious.bind(this)(t.currentSlide)}this.transitionTypes[t.transitionType].checkNext.bind(this)();this._trigger("next")},customPrev:function(){var t=this.options,i=t.currentSlide-t.incrementAmount<=0?0:t.currentSlide-t.incrementAmount;this.pause(true);this.showSlide(i);if(t.hidePreviousOnFirstSlide){this.transitionTypes[t.transitionType].checkPrevious.bind(this)(t.currentSlide)}this.transitionTypes[t.transitionType].checkNext.bind(this)();this._trigger("previous")},setWidthsCustom:function(){var t=this.options,i=this.items.container.$element.width(),e=this.transitionTypes[t.transitionType].getCanvasWidth.bind(this)(),s=t.currentSlide;if(i>e){this.items.canvas.$element.animate({left:0},t.transitionDuration,t.transitionEasing);this.options.currentSlide=0;s=0}if(t.hidePreviousOnFirstSlide){this.transitionTypes[t.transitionType].checkPrevious.bind(this)(s)}this.transitionTypes[t.transitionType].checkNext.bind(this)()},checkNext:function(){var t=this.options,i=this.items.slides.$elements.length,e=this.items.container.$element.width(),s=this.transitionTypes[t.transitionType].getCanvasWidth.bind(this)(),n=0,h=t.currentSlide;if(e<=s){for(var l=h;l<i;l++){n+=o(this.items.slides.$elements[l]).width();if(n>=e){this.options.incrementAmount=l-h;break}}}o(this.items.next.selector,this.$element).css("visibility",e>=s||e>=n||h==i-1?"hidden":"visible");if(this.$element.hasClass("first")&&h!==0){this.$element.removeClass("first")}},checkPrevious:function(t){var i=this.options,e=this.items.container.$element.width(),s=this.transitionTypes[i.transitionType].getCanvasWidth.bind(this)(),n=0;if(e<=s){for(var h=t;h>=0;h--){n+=o(this.items.slides.$elements[h]).width();if(n>=e){this.options.incrementAmount=t-h;break}}}if(t===0){o(this.items.prev.selector,this.$element).css("visibility","hidden");this.$element.addClass("first")}else{o(this.items.prev.selector,this.$element).css("visibility","visible");this.$element.removeClass("first")}},getCanvasWidth:function(){var t=this.items.slides.$elements.length,i=0;for(var e=0;e<t;e++){i+=o(this.items.slides.$elements[e]).width()+2}this.items.canvas.$element.width(i);return i}}},_create:function(t){var i=this.options;this._super(t);if(typeof this.transitionTypes[i.transitionType].postInit=="function"){this.transitionTypes[i.transitionType].postInit.bind(this)()}},showSlide:function(t,i){var e=this.options,i=typeof i==="undefined"?false:i;if(!i){this.transitionTypes[e.transitionType].showSlide.bind(this)(t)}else{this.transitionTypes[e.transitionType].showSlideGoto.bind(this)(t)}if(!this.infinite){this.items.slides.$elements.removeClass(e.classSelected);this.items.jumps.$elements.removeClass(e.classSelected);o(this.items.slides.$elements[t]).addClass(e.classSelected);if(this.items.jumps.$elements.length>0){o(this.items.jumps.$elements[t]).addClass(e.classSelected)}e.currentSlide=t}if(e.updatePagination){this._updatePushState(o(this.items.slides.$elements[t]).data(e.pageUrlAttribute))}this._trigger("slidechanged")},goto:function(t){var i=this.options;this.pause(true);this.showSlide(t,this.infinite);if(i.hidePreviousOnFirstSlide)this.checkPreviousButton(t);this._trigger("goto")},setWidths:function(){var t=this.options;this.slideWidth=this.items.container.$element.width()/this.options.numOfVisibleSlides;this.items.slides.$elements.width(this.slideWidth);this.items.canvas.$element.width(this.slideWidth*this.items.slides.$elements.length);this.items.canvas.$element.css("left",-this.slideWidth*t.currentSlide)}})});